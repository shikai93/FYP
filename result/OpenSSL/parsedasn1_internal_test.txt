Copyright 1999-2017 The OpenSSL Project Authors. All Rights Reserved. Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at https://www.openssl.org/source/license.html

Internal tests for the asn1 module

Test of a_strnid's tbl_standard

Test of ameth_lib's standard_methods

www.openssl.org/source/license.html

License

testutil.h

internal/nelem.h

s tbl_standard * ***/ #include "../crypto/asn1/tbl_standard.h" static int test_tbl_standard() { const ASN1_STRING_TABLE *tmp; int last_nid = -1; size_t i; for (tmp = tbl_standard, i = 0; i < OSSL_NELEM(tbl_standard); i++, tmp++) { if (tmp->nid < last_nid) { last_nid = 0; break; } last_nid = tmp->nid; } if (TEST_int_ne(last_nid, 0)) { TEST_info("asn1 tbl_standard: Table order OK"); return 1; } TEST_info("asn1 tbl_standard: out of order"); for (tmp = tbl_standard, i = 0; i < OSSL_NELEM(tbl_standard); i++, tmp++) TEST_note("asn1 tbl_standard: Index %zu, NID %d, Name=%s", i, tmp->nid, OBJ_nid2ln(tmp->nid)); return 0; } /********************************************************************** * * Test of ameth_lib

internal/asn1_int.h

../crypto/asn1/standard_methods.h

asn1 standard methods: Table order OK

asn1 standard methods: out of order

asn1 standard methods: Index %zu, pkey ID %d, Name=%s

