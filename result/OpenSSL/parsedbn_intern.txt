Copyright 2014-2016 The OpenSSL Project Authors. All Rights Reserved. Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at https://www.openssl.org/source/license.html

Determine the modified width-(w+1) Non-Adjacent Form (wNAF) of 'scalar'. This is an array r[] of values that are either zero or odd with an absolute value less than 2^w satisfying scalar = \sum_j r[j]2^j where at most one of any w+1 consecutive digits is non-zero with the exception that the most significant digit may be only w-1 zeros away from that next non-zero digit.

'signed char' can represent integers with absolute values less than 2^7

at most 128

at most 256

at most 255

Modified wNAF may be one digit longer than binary representation (ret_len will be set to the actual length, i.e. at most BN_num_bits(scalar) + 1)

if j+w+1 >= len, window_val will not increase

0 <= window_val <= 2^(w+1)

0 < window_val < 2^(w+1)

-2^w < digit < 0

modified wNAF

Special case for generating modified wNAFs: no new bits will be added into window_val, so using a positive digit here will decrease the total length of the representation

0 < digit < 2^w

0 < digit < 2^w

now window_val is 0 or 2^(w+1) in standard wNAF generation; for modified window NAFs, it may also be 2^w

www.openssl.org/source/license.html

License

internal/cryptlib.h

bn_lcl.h

scalar

signed char

