Copyright 2010-2016 The OpenSSL Project Authors. All Rights Reserved. Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at https://www.openssl.org/source/license.html

Cipher context to use

Keys k1 and k2

Temporary block

Last (possibly partial) block

Number of bytes in last block: -1 means context not initialised

Make temporary keys K1 and K2

Shift block to left, including carry

If MSB set fixup with R

All zeros means restart

Not initialised

Initialise context

Non-NULL key means initialisation complete

Reset context again ready for first data block

Zero tbl so resume works

Copy into partial block if we need to

If no more to process return

Else not final block so encrypt it

Encrypt all but one of the complete blocks left

Copy any data left to last block buffer

Is last block complete?

The buffer "tbl" contains the last fully encrypted block which is the last IV (or all zeroes if no last encrypted block). The last block has not been modified since CMAC_final(). So reinitialising using the last decrypted block will allow CMAC to continue after calling CMAC_Final().

www.openssl.org/source/license.html

License

internal/cryptlib.h

tbl

0x87

0x1b));

0x80;

Copyright 2010-2016 The OpenSSL Project Authors. All Rights Reserved. Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at https://www.openssl.org/source/license.html

Opaque

www.openssl.org/source/license.html

License

C

