Copyright 2008-2017 The OpenSSL Project Authors. All Rights Reserved. Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at https://www.openssl.org/source/license.html

CMS utility function

If previous -signer argument add signer to list

If previous -inkey argument add signer to list

Check to see if any final signer needs to be appended

NULL these because call absorbs them

If detached data content we enable streaming if S/MIME output format.

If not streaming or resigning finalize structure

Minimal callback just to output policy info (if any)

www.openssl.org/source/license.html

License

apps.h

-

Usage: %s [options] cert.pem...\n

-

cert.pem... recipient certs for encryption\n

-

Valid options are:\n

help

-

Display this summary

inform

c

Input format SMIME (default), PEM or DER

outform

c

Output format SMIME (default), PEM or DER

in

<

Input file

out

>

Output file

encrypt

-

Encrypt message

decrypt

-

Decrypt encrypted message

sign

-

Sign message

sign_receipt

-

Generate a signed receipt for the message

resign

-

Resign a signed message

verify

-

Verify signed message

verify_retcode

-

verify_receipt

<

cmsout

-

Output CMS structure

data_out

-

data_create

-

digest_verify

-

digest_create

-

compress

-

uncompress

-

EncryptedData_decrypt

-

EncryptedData_encrypt

-

debug_decrypt

-

text

-

Include or delete text MIME headers

asciicrlf

-

nointern

-

Don't search certificates in message for signer

noverify

-

Don't verify signers certificate

nocerts

-

Don't include signers certificate when signing

noattr

-

Don't include any signed attributes

nodetach

-

Use opaque signing

nosmimecap

-

Omit the SMIMECapabilities attribute

binary

-

Don't translate message to text

keyid

-

Use subject key identifier

nosigs

-

Don't verify message signature

no_content_verify

-

no_attr_verify

-

stream

-

Enable CMS streaming

indef

-

Same as -stream

noindef

-

Disable CMS streaming

crlfeol

-

Use CRLF as EOL termination instead of CR only

noout

-

For the -cmsout operation do not output the parsed CMS structure

receipt_request_print

-

Print CMS Receipt Request

receipt_request_all

-

receipt_request_first

-

rctform

F

Receipt file format

certfile

<

Other certificates file

CAfile

<

Trusted certificates file

CApath

/

trusted certificates directory

no-CAfile

-

Do not load the default certificates file

no-CApath

-

Do not load certificates from the default certificates directory

content

<

Supply or override content for detached signature

print

-

For the -cmsout operation print out all fields of the CMS structure

secretkey

s

secretkeyid

s

pwri_password

s

econtent_type

s

passin

s

Input file pass phrase source

to

s

To address

from

s

From address

subject

s

Subject

signer

s

Signer certificate file

recip

<

Recipient cert file for decryption

certsout

>

Certificate output file

md

s

Digest algorithm to use when signing or resigning

inkey

s

Input private key (if not signer or recipient)

keyform

f

Input private key format (PEM or ENGINE)

keyopt

s

Set public key parameters as n:v pairs

receipt_request_from

s

receipt_request_to

s



-

Any supported cipher

aes128-wrap

-

Use AES128 to wrap key

aes192-wrap

-

Use AES192 to wrap key

aes256-wrap

-

Use AES256 to wrap key

des3-wrap

-

Use 3DES-EDE to wrap key

engine

s

Use engine e, possibly a hardware device

\n

%s: Use -help for summary.\n

\r\n

Invalid key (supplied twice) %s\n

Invalid key %s\n

Invalid id (supplied twice) %s\n

Invalid id %s\n

Invalid OID (supplied twice) %s\n

Invalid OID %s\n

Illegal -inkey without -signer\n

recipient certificate file

No key specified\n

key param buffer

No Signed Receipts Recipients\n

Signed receipts only allowed with -sign\n

Multiple signers or keys not allowed\n

Illegal -inkey without -signer\n

No signer certificate specified\n

No recipient certificate or key specified\n

No recipient(s) certificate(s) specified\n

Error getting password\n

No cipher selected\n

No secret key id\n

recipient certificate file

certificate file

recipient certificate file

receipt signer certificate file

signing key file

r

Bad input format for CMS file\n

Error reading S/MIME message\n

rb

Can't read content file %s\n

Error writing certs to %s\n

rb

r

Can't open receipt file %s\n

Bad input format for receipt\n

Error reading receipt\n

w

Signed Receipt Request Creation Error\n

signer certificate

signing key file

Error creating CMS structure\n

Error decrypting CMS using secret key\n

Error decrypting CMS using private key\n

Error decrypting CMS using password\n

Error decrypting CMS structure\n

Verification successful\n

Verification failure\n

Verification successful\n

Verification failure\n

Error writing signers to %s\n

Verification successful\n

Verification failure\n

To: %s%s

From: %s%s

Subject: %s%s

Bad output format for CMS file\n

w



\n

Signer %d:\n

No Receipt Request\n

Receipt Request Parse Error\n

Signed Content ID:\n

Receipts From

List:\n

: First Tier\n

: All\n

Unknown (%d)\n

Receipts To:\n

parameter error \"%s\"\n

0x10

0x20

0x40

Copyright 2016 The OpenSSL Project Authors. All Rights Reserved. Licensed under the OpenSSL licenses, (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at https://www.openssl.org/source/license.html or in the file LICENSE in the source distribution.

Test CMS DER parsing.

www.openssl.org/source/license.html

License

fuzzer.h

Copyright 2008-2016 The OpenSSL Project Authors. All Rights Reserved. Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at https://www.openssl.org/source/license.html

S/MIME related flags

Backward compatibility for spelling errors.

www.openssl.org/source/license.html

License

C

0x1

0x2

0x4

0x8

0x10

0x20

0x20

0x40

0x80

0x100

0x200

0x400

0x800

0x1000

0x2000

0x4000

0x8000

0x10000

0x20000

0x40000

0x80000

