Copyright 2006-2016 The OpenSSL Project Authors. All Rights Reserved. Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at https://www.openssl.org/source/license.html

i2d/d2i like DH parameter functions which use the appropriate routine for PKCS#3 DH or X9.42 DH.

We have parameters now set public key

PKCS#8 DH is defined in PKCS#11 of all places. It is similar to DH in that the AlgorithmIdentifier contains the parameters, the private key is explicitly included and the pubkey must be recalculated.

We have parameters now set private key

Calculate public key

Get private key into integer

Only absent parameters allowed in RFC XXXX

Get parameters from parent key

We have parameters now set public key

We have parameters now set public key

For DH we only have one OID permissible. If ever any more get defined we will need something cleverer.

Use OBJ_nid2obj to ensure we use built in OID that isn't freed

See if we need to set peer key

Set DH derivation parameters and initialise unwrap context

Get ephemeral key

Is everything uninitialised?

Set the key

See if custom parameters set

Unknown KDF

Only SHA1 supported

Unsupported digest

Get wrap NID

Package wrap algorithm in an AlgorithmIdentifier

Now need to wrap encoding of wrap AlgorithmIdentifier into parameter of another AlgorithmIdentifier.

www.openssl.org/source/license.html

License

internal/cryptlib.h

dh_locl.h

internal/asn1_int.h

internal/evp_int.h

DH Private-Key

DH Public-Key

DH Parameters

%s: (%d bit)\n

private-key:

public-key:

prime:

generator:

subgroup order:

subgroup factor:

seed:

\n

%02x%s



:

\n

counter:

recommended-private-length: %d bits\n

DH

OpenSSL PKCS#3 DH method

X9.42 DH

OpenSSL X9.42 DH method

0x07);

