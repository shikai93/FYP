Copyright 1995-2017 The OpenSSL Project Authors. All Rights Reserved. Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at https://www.openssl.org/source/license.html

Check that p and g are suitable enough p is odd 1 < g < p - 1

Check that p is a safe prime and if g is 2, 3 or 5, check that it is a suitable generator where for 2, p mod 24 == 11 for 3, p mod 12 == 5 for 5, p mod 10 == 3 or 7 should hold.

Check g^q == 1 mod p

Check p == 1 mod q i.e. q divides p - 1

Check pub_key^q == 1 mod p

www.openssl.org/source/license.html

License

internal/cryptlib.h

dh_locl.h

