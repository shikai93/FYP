Copyright 2016-2017 The OpenSSL Project Authors. All Rights Reserved. Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at https://www.openssl.org/source/license.html

Just a ClientHello without a cookie

Handshake

DTLSv1.0

Epoch

Record sequence number

Record Length

ClientHello

Message length

Message sequence

Fragment offset

Fragment length

DTLSv1.2

Random

Session id len

Cookie len

Ciphersuites len

AES128-SHA

Empty reneg info SCSV

Compression methods len

Null compression

Extensions len

First fragment of a ClientHello without a cookie

Handshake

DTLSv1.0

Epoch

Record sequence number

Record Length

ClientHello

Message length

Message sequence

Fragment offset

Fragment length

DTLSv1.2

Random

Session id len

Cookie len

First fragment of a ClientHello which is too short

Handshake

DTLSv1.0

Epoch

Record sequence number

Record Length

ClientHello

Message length

Message sequence

Fragment offset

Fragment length

DTLSv1.2

Random

Session id len

Second fragment of a ClientHello

Handshake

DTLSv1.0

Epoch

Record sequence number

Record Length

ClientHello

Message length

Message sequence

Fragment offset

Fragment length

Version skipped - sent in first fragment

Random

Session id len

Cookie len

Ciphersuites len

AES128-SHA

Empty reneg info SCSV

Compression methods len

Null compression

Extensions len

A ClientHello with a good cookie

Handshake

DTLSv1.0

Epoch

Record sequence number

Record Length

ClientHello

Message length

Message sequence

Fragment offset

Fragment length

DTLSv1.2

Random

Session id len

Cookie len

Cookie

Ciphersuites len

AES128-SHA

Empty reneg info SCSV

Compression methods len

Null compression

Extensions len

A fragmented ClientHello with a good cookie

Handshake

DTLSv1.0

Epoch

Record sequence number

Record Length

ClientHello

Message length

Message sequence

Fragment offset

Fragment length

DTLSv1.2

Random

Session id len

Cookie len

Cookie

A ClientHello with a bad cookie

Handshake

DTLSv1.0

Epoch

Record sequence number

Record Length

ClientHello

Message length

Message sequence

Fragment offset

Fragment length

DTLSv1.2

Random

Session id len

Cookie len

Cookie

Ciphersuites len

AES128-SHA

Empty reneg info SCSV

Compression methods len

Null compression

Extensions len

A fragmented ClientHello with the fragment boundary mid cookie

Handshake

DTLSv1.0

Epoch

Record sequence number

Record Length

ClientHello

Message length

Message sequence

Fragment offset

Fragment length

DTLSv1.2

Random

Session id len

Cookie len

Cookie

Bad record - too short

Handshake

DTLSv1.0

Epoch

Record sequence number

Handshake

DTLSv1.0

Epoch

Record sequence number

Record Length

HelloVerifyRequest

Message length

Message sequence

Fragment offset

Fragment length

DTLSv1.0

Cookie len

Cookie

GOOD == positive return value from DTLSv1_listen, no output yet VERIFY == 0 return value, HelloVerifyRequest sent DROP == 0 return value, no output

Create an SSL object and set the BIO

Set Non-blocking IO behaviour

Process the incoming packet

Also frees up outbio

www.openssl.org/source/license.html

License

internal/nelem.h

testutil.h

Test %d: unexpected data output

0x16,

0xFE,

0xFF,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x3A,

0x01,

0x00,

0x00,

0x2E,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x2E,

0xFE,

0xFD,

0xCA,

0x18,

0x9F,

0x76,

0xEC,

0x57,

0xCE,

0xE5,

0xB3,

0xAB,

0x79,

0x90,

0xAD,

0xAC,

0x6E,

0xD1,

0x58,

0x35,

0x03,

0x97,

0x16,

0x10,

0x82,

0x56,

0xD8,

0x55,

0xFF,

0xE1,

0x8A,

0xA3,

0x2E,

0xF6,

0x00,

0x00,

0x00,

0x04,

0x00,

0x2f,

0x00,

0xff,

0x01,

0x00,

0x00,

0x00

0x16,

0xFE,

0xFF,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x30,

0x01,

0x00,

0x00,

0x2E,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x24,

0xFE,

0xFD,

0xCA,

0x18,

0x9F,

0x76,

0xEC,

0x57,

0xCE,

0xE5,

0xB3,

0xAB,

0x79,

0x90,

0xAD,

0xAC,

0x6E,

0xD1,

0x58,

0x35,

0x03,

0x97,

0x16,

0x10,

0x82,

0x56,

0xD8,

0x55,

0xFF,

0xE1,

0x8A,

0xA3,

0x2E,

0xF6,

0x00,

0x00

0x16,

0xFE,

0xFF,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x2F,

0x01,

0x00,

0x00,

0x2E,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x23,

0xFE,

0xFD,

0xCA,

0x18,

0x9F,

0x76,

0xEC,

0x57,

0xCE,

0xE5,

0xB3,

0xAB,

0x79,

0x90,

0xAD,

0xAC,

0x6E,

0xD1,

0x58,

0x35,

0x03,

0x97,

0x16,

0x10,

0x82,

0x56,

0xD8,

0x55,

0xFF,

0xE1,

0x8A,

0xA3,

0x2E,

0xF6,

0x00

0x16,

0xFE,

0xFF,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x38,

0x01,

0x00,

0x00,

0x2E,

0x00,

0x00,

0x00,

0x00,

0x02,

0x00,

0x00,

0x2C,

0xCA,

0x18,

0x9F,

0x76,

0xEC,

0x57,

0xCE,

0xE5,

0xB3,

0xAB,

0x79,

0x90,

0xAD,

0xAC,

0x6E,

0xD1,

0x58,

0x35,

0x03,

0x97,

0x16,

0x10,

0x82,

0x56,

0xD8,

0x55,

0xFF,

0xE1,

0x8A,

0xA3,

0x2E,

0xF6,

0x00,

0x00,

0x00,

0x04,

0x00,

0x2f,

0x00,

0xff,

0x01,

0x00,

0x00,

0x00

0x16,

0xFE,

0xFF,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x4E,

0x01,

0x00,

0x00,

0x42,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x42,

0xFE,

0xFD,

0xCA,

0x18,

0x9F,

0x76,

0xEC,

0x57,

0xCE,

0xE5,

0xB3,

0xAB,

0x79,

0x90,

0xAD,

0xAC,

0x6E,

0xD1,

0x58,

0x35,

0x03,

0x97,

0x16,

0x10,

0x82,

0x56,

0xD8,

0x55,

0xFF,

0xE1,

0x8A,

0xA3,

0x2E,

0xF6,

0x00,

0x14,

0x00,

0x01,

0x02,

0x03,

0x04,

0x06,

0x08,

0x09,

0x0A,

0x0B,

0x0C,

0x0D,

0x0E,

0x0F,

0x10,

0x11,

0x12,

0x13,

0x00,

0x04,

0x00,

0x2f,

0x00,

0xff,

0x01,

0x00,

0x00,

0x00

0x16,

0xFE,

0xFF,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x44,

0x01,

0x00,

0x00,

0x42,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x38,

0xFE,

0xFD,

0xCA,

0x18,

0x9F,

0x76,

0xEC,

0x57,

0xCE,

0xE5,

0xB3,

0xAB,

0x79,

0x90,

0xAD,

0xAC,

0x6E,

0xD1,

0x58,

0x35,

0x03,

0x97,

0x16,

0x10,

0x82,

0x56,

0xD8,

0x55,

0xFF,

0xE1,

0x8A,

0xA3,

0x2E,

0xF6,

0x00,

0x14,

0x00,

0x01,

0x02,

0x03,

0x04,

0x06,

0x08,

0x09,

0x0A,

0x0B,

0x0C,

0x0D,

0x0E,

0x0F,

0x10,

0x11,

0x12,

0x13

0x16,

0xFE,

0xFF,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x4E,

0x01,

0x00,

0x00,

0x42,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x42,

0xFE,

0xFD,

0xCA,

0x18,

0x9F,

0x76,

0xEC,

0x57,

0xCE,

0xE5,

0xB3,

0xAB,

0x79,

0x90,

0xAD,

0xAC,

0x6E,

0xD1,

0x58,

0x35,

0x03,

0x97,

0x16,

0x10,

0x82,

0x56,

0xD8,

0x55,

0xFF,

0xE1,

0x8A,

0xA3,

0x2E,

0xF6,

0x00,

0x14,

0x01,

0x01,

0x02,

0x03,

0x04,

0x06,

0x08,

0x09,

0x0A,

0x0B,

0x0C,

0x0D,

0x0E,

0x0F,

0x10,

0x11,

0x12,

0x13,

0x00,

0x04,

0x00,

0x2f,

0x00,

0xff,

0x01,

0x00,

0x00,

0x00

0x16,

0xFE,

0xFF,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x43,

0x01,

0x00,

0x00,

0x42,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x37,

0xFE,

0xFD,

0xCA,

0x18,

0x9F,

0x76,

0xEC,

0x57,

0xCE,

0xE5,

0xB3,

0xAB,

0x79,

0x90,

0xAD,

0xAC,

0x6E,

0xD1,

0x58,

0x35,

0x03,

0x97,

0x16,

0x10,

0x82,

0x56,

0xD8,

0x55,

0xFF,

0xE1,

0x8A,

0xA3,

0x2E,

0xF6,

0x00,

0x14,

0x00,

0x01,

0x02,

0x03,

0x04,

0x06,

0x08,

0x09,

0x0A,

0x0B,

0x0C,

0x0D,

0x0E,

0x0F,

0x10,

0x11,

0x12

0x16,

0xFE,

0xFF,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00

0x16,

0xFE,

0xFF,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x23,

0x03,

0x00,

0x00,

0x17,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x00,

0x17,

0xFE,

0xFF,

0x14,

0x00,

0x01,

0x02,

0x03,

0x04,

0x06,

0x08,

0x09,

0x0A,

0x0B,

0x0C,

0x0D,

0x0E,

0x0F,

0x10,

0x11,

0x12,

0x13

