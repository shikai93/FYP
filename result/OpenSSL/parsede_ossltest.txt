Copyright 2015-2016 The OpenSSL Project Authors. All Rights Reserved. Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at https://www.openssl.org/source/license.html

This is the OSSLTEST engine. It provides deliberately crippled digest implementations for test purposes. It is highly insecure and must NOT be used for any purpose except testing

Engine Id and Name

Engine Lifetime functions

Set up digests

MD5

SHA1

SHA256

SHA384/SHA512

Setup ciphers

AES128

block size

key len

block size

key len

Ensure the ossltest error handling is set up

Copied from eng_[openssl|dyn].c

We are returning a list of supported nids

We are being asked for a specific digest

We are returning a list of supported nids

We are being asked for a specific cipher

MD5 implementation. We go through the motions of doing MD5 by deferring to the standard implementation. Then we overwrite the result with a will defined value, so that all "MD5" digests using the test engine always end up with the same value.

SHA1 implementation.

SHA256 implementation.

SHA384/512 implementation.

Actually uses SHA512_Final!

AES128 Implementation

Remember what we were asked to encrypt

Go through the motions of encrypting it

Throw it all away and just use the plaintext as the output

OPENSSL_malloc will return NULL if inl == 0

Remember what we were asked to encrypt

Go through the motions of encrypting it

Throw it all away and just use the plaintext as the output

Pass the ctrl down

Always give the same tag

www.openssl.org/source/license.html

License

e_ossltest_err.c

ossltest

OpenSSL Test engine support

MD5

0xff);

www.openssl.org/source/license.html

License

