Copyright 2001-2017 The OpenSSL Project Authors. All Rights Reserved. Copyright (c) 2002, Oracle and/or its affiliates. All rights reserved Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at https://www.openssl.org/source/license.html

test multiplication with group order, long and negative scalars

If i == 1, P will be the predefined generator for which EC_GROUP_precompute_mult has set up precomputation.

n1 = 1 - order

n2 = 1 + order

n2 = (1 - order) (1 + order) = 1 - order^2

n2 = order^2 - 1

Add P to verify the result.

Exercise EC_POINTs_mul, including corner cases.

=> infinity

=> -P

=> infinity

=> infinity

=> P

=> infinity

applications should use EC_GROUP_new_curve_GFp so that the library gets to choose the EC_METHOD

Curve secp160r1 (Certicom Research SEC 2 Version 1.0, section 2.4.2, 2000) -- not a NIST curve, but commonly used

When (x, y) is on the curve, (x, y + 1) is, as it happens, not, and therefore setting the coordinates should fail.

G_y value taken from the standard:

Curve P-192 (FIPS PUB 186-2, App. 6)

G_y value taken from the standard:

When (x, y) is on the curve, (x, y + 1) is, as it happens, not, and therefore setting the coordinates should fail.

Curve P-224 (FIPS PUB 186-2, App. 6)

G_y value taken from the standard:

When (x, y) is on the curve, (x, y + 1) is, as it happens, not, and therefore setting the coordinates should fail.

Curve P-256 (FIPS PUB 186-2, App. 6)

G_y value taken from the standard:

When (x, y) is on the curve, (x, y + 1) is, as it happens, not, and therefore setting the coordinates should fail.

Curve P-384 (FIPS PUB 186-2, App. 6)

G_y value taken from the standard:

When (x, y) is on the curve, (x, y + 1) is, as it happens, not, and therefore setting the coordinates should fail.

Curve P-521 (FIPS PUB 186-2, App. 6)

G_y value taken from the standard:

When (x, y) is on the curve, (x, y + 1) is, as it happens, not, and therefore setting the coordinates should fail.

more tests using the last curve

Restore the point that got mangled in the (x, y + 1) test.

P = -2Q

R = P + 2Q

(group order + 1)/2, so yQ + yQ = Q

z is still the group order

z = -(order + y)

z = -(x+y)

Curve K-163 (FIPS PUB 186-2, App. 6)

Curve B-163 (FIPS PUB 186-2, App. 6)

Curve K-233 (FIPS PUB 186-2, App. 6)

Curve B-233 (FIPS PUB 186-2, App. 6)

Curve K-283 (FIPS PUB 186-2, App. 6)

Curve B-283 (FIPS PUB 186-2, App. 6)

Curve K-409 (FIPS PUB 186-2, App. 6)

Curve B-409 (FIPS PUB 186-2, App. 6)

Curve K-571 (FIPS PUB 186-2, App. 6)

Curve B-571 (FIPS PUB 186-2, App. 6)

Change test based on whether binary point compression is enabled or not.

When (x, y) is on the curve, (x, y + 1) is, as it happens, not, and therefore setting the coordinates should fail.

G_y value taken from the standard:

When (x, y) is on the curve, (x, y + 1) is, as it happens, not, and therefore setting the coordinates should fail.

more tests using the last curve

P = -2Q

R = P + 2Q

(group order + 1)/2, so yQ + yQ = Q

z is still the group order

z = -(order + y)

z = -(x+y)

applications should use EC_GROUP_new_curve_GF2m so that the library gets to choose the EC_METHOD

Change test based on whether binary point compression is enabled or not.

Change test based on whether binary point compression is enabled or not.

Change test based on whether binary point compression is enabled or not.

Change test based on whether binary point compression is enabled or not.

Skip for X25519 because low level operations such as EC_POINT_mul() are not supported for this curve

nistp_test_params contains magic numbers for testing our optimized implementations of several NIST curves with characteristic > 3.

Qx, Qy and D are taken from http://csrc.nist.gov/groups/ST/toolkit/documents/Examples/ECDSA_Prime.pdf Otherwise, values are standard curve parameters from FIPS 180-3

P-224

p

a

b

Qx

Qy

Gx

Gy

order

d

P-256

p

a

b

Qx

Qy

Gx

Gy

order

d

P-521

p

a

b

Qx

Qy

Gx

Gy

order

d

When (x, y) is on the curve, (x, y + 1) is, as it happens, not, and therefore setting the coordinates should fail.

fixed point multiplication

random point multiplication

set generator to P = 2G, where G is the standard generator

set the scalar to m=n/2, where n is the NIST test scalar

test the non-standard generator

fixed point multiplication

random point multiplication

We have not performed precomputation so have_precompute mult should be false

now repeat all tests with precomputation

fixed point multiplication

random point multiplication

reset generator

fixed point multiplication

random point multiplication

www.openssl.org/source/license.html

csrc.nist.gov/groups/ST/toolkit/documents/Examples/ECDSA_Prime.pdf

License

internal/nelem.h

testutil.h

allowing precomputation

without precomputation

17

1

1

Curve defined by Weierstrass equation

y^2 = x^3 + a*x + b (mod p)

a

b

p

D

Point is not on curve

x

y

A cyclic subgroup:

point at infinity

x

y

Generator as octet string, compressed form:

Generator as octet string, uncompressed form:

Generator as octet string, hybrid form:

A representation of the inverse of that generator in

Jacobian projective coordinates

x

y

z

FFFFFFFF

FFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF

FFFFFFFF

FFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC

1C97BEFC

54BD7A8B65ACF89F81D4D4ADC565FA45

4A96B568

8EF573284664698968C38BB913CBFC82

23a62855

3168947d59dcc912042351377ac5fb32

0100000000

000000000001F4C8F927AED3CA752257

SEC2 curve secp160r1 -- Generator

x

y

23a62855

3168947d59dcc912042351377ac5fb32

FFFFFFFFFFFFFFFF

FFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF

FFFFFFFFFFFFFFFF

FFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC

64210519E59C80E7

0FA7E9AB72243049FEB8DEECC146B9B1

188DA80EB03090F6

7CBF20EB43A18800F4FF0AFD82FF1012

FFFFFFFFFFFFFFFF

FFFFFFFF99DEF836146BC9B1B4D22831

NIST curve P-192 -- Generator

x

y

07192B95FFC8DA78

631011ED6B24CDD573F977A11E794811

FFFFFFFFFFFFFFFFFFFFFFFF

FFFFFFFF000000000000000000000001

FFFFFFFFFFFFFFFFFFFFFFFF

FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE

B4050A850C04B3ABF5413256

5044B0B7D7BFD8BA270B39432355FFB4

B70E0CBD6BB4BF7F321390B9

4A03C1D356C21122343280D6115C1D21

FFFFFFFFFFFFFFFFFFFFFFFF

FFFF16A2E0B8F03E13DD29455C5C2A3D

NIST curve P-224 -- Generator

x

y

BD376388B5F723FB4C22DFE6

CD4375A05A07476444D5819985007E34

FFFFFFFF000000010000000000000000

00000000FFFFFFFFFFFFFFFFFFFFFFFF

FFFFFFFF000000010000000000000000

00000000FFFFFFFFFFFFFFFFFFFFFFFC

5AC635D8AA3A93E7B3EBBD55769886BC

651D06B0CC53B0F63BCE3C3E27D2604B

6B17D1F2E12C4247F8BCE6E563A440F2

77037D812DEB33A0F4A13945D898C296

FFFFFFFF00000000FFFFFFFFFFFFFFFF

BCE6FAADA7179E84F3B9CAC2FC632551

NIST curve P-256 -- Generator

x

y

4FE342E2FE1A7F9B8EE7EB4A7C0F9E16

2BCE33576B315ECECBB6406837BF51F5

FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF

FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE

FFFFFFFF0000000000000000FFFFFFFF

FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF

FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE

FFFFFFFF0000000000000000FFFFFFFC

B3312FA7E23EE7E4988E056BE3F82D19

181D9C6EFE8141120314088F5013875A

C656398D8A2ED19D2A85C8EDD3EC2AEF

AA87CA22BE8B05378EB1C71EF320AD74

6E1D3B628BA79B9859F741E082542A38

5502F25DBF55296C3A545E3872760AB7

FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF

FFFFFFFFFFFFFFFFC7634D81F4372DDF

581A0DB248B0A77AECEC196ACCC52973

NIST curve P-384 -- Generator

x

y

3617DE4A96262C6F5D9E98BF9292DC29

F8F41DBD289A147CE9DA3113B5F0B8C0

0A60B1CE1D7E819D7A431D7C90EA0E5F

1FF

FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF

FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF

FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF

FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF

1FF

FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF

FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF

FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF

FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC

051

953EB9618E1C9A1F929A21A0B68540EE

A2DA725B99B315F3B8B489918EF109E1

56193951EC7E937B1652C0BD3BB1BF07

3573DF883D2C34F1EF451FD46B503F00

C6

858E06B70404E9CD9E3ECB662395B442

9C648139053FB521F828AF606B4D3DBA

A14B5E77EFE75928FE1DC127A2FFA8DE

3348B3C1856A429BF97E7E31C2E5BD66

1FF

FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF

FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA

51868783BF2F966B7FCC0148F709A5D0

3BB5C9B8899C47AEBB6FB71E91386409

NIST curve P-521 -- Generator

x

y

118

39296A789A3BC0045C8A5FB42C7D1BD9

98F54449579B446817AFBD17273E662C

97EE72995EF42640C550B9013FAD0761

353C7086A272C24088BE94769FD16650

combined multiplication ...

ok\n

NIST curve K-163

0800000000000000000000000000000000000000C9

1

1

02FE13C0537BBC11ACAA07D793DE4E6D5E5C94EEE8

0289070FB05D38FF58321F2E800536D538CCDAA3D9

04000000000000000000020108A2E0CC0D99F8A5EF

2

NIST curve B-163

0800000000000000000000000000000000000000C9

1

020A601907B8C953CA1481EB10512F78744A3205FD

03F0EBA16286A2D57EA0991168D4994637E8343E36

00D51FBC6C71A0094FA2CDD545B11C5C0C797324F1

040000000000000000000292FE77E70C12A4234C33

2

NIST curve K-233

020000000000000000000000000000000000000004000000000000000001

0

1

017232BA853A7E731AF129F22FF4149563A419C26BF50A4C9D6EEFAD6126

01DB537DECE819B7F70F555A67C427A8CD9BF18AEB9B56E0C11056FAE6A3

008000000000000000000000000000069D5BB915BCD46EFB1AD5F173ABDF

4

NIST curve B-233

020000000000000000000000000000000000000004000000000000000001

000000000000000000000000000000000000000000000000000000000001

0066647EDE6C332C7F8C0923BB58213B333B20E9CE4281FE115F7D8F90AD

00FAC9DFCBAC8313BB2139F1BB755FEF65BC391F8B36F8F8EB7371FD558B

01006A08A41903350678E58528BEBF8A0BEFF867A7CA36716F7E01F81052

01000000000000000000000000000013E974E72F8A6922031D2603CFE0D7

2

NIST curve K-283

08000000

00000000000000000000000000000000000000000000000000000000000010A1

0

1

0503213F

78CA44883F1A3B8162F188E553CD265F23C1567A16876913B0C2AC2458492836

01CCDA38

0F1C9E318D90F95D07E5426FE87E45C0E8184698E45962364E34116177DD2259

01FFFFFF

FFFFFFFFFFFFFFFFFFFFFFFFFFFFE9AE2ED07577265DFF7F94451E061E163C61

4

NIST curve B-283

08000000

00000000000000000000000000000000000000000000000000000000000010A1

00000000

0000000000000000000000000000000000000000000000000000000000000001

027B680A

C8B8596DA5A4AF8A19A0303FCA97FD7645309FA2A581485AF6263E313B79A2F5

05F93925

8DB7DD90E1934F8C70B0DFEC2EED25B8557EAC9C80E2E198F8CDBECD86B12053

03676854

FE24141CB98FE6D4B20D02B4516FF702350EDDB0826779C813F0DF45BE8112F4

03FFFFFF

FFFFFFFFFFFFFFFFFFFFFFFFFFFFEF90399660FC938A90165B042A7CEFADB307

2

NIST curve K-409

0200000000000000000000000000000000000000

0000000000000000000000000000000000000000008000000000000000000001

0

1

0060F05F658F49C1AD3AB1890F7184210EFD0987

E307C84C27ACCFB8F9F67CC2C460189EB5AAAA62EE222EB1B35540CFE9023746

01E369050B7C4E42ACBA1DACBF04299C3460782F

918EA427E6325165E9EA10E3DA5F6C42E9C55215AA9CA27A5863EC48D8E0286B

007FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF

FFFFFFFFFFFFFE5F83B2D4EA20400EC4557D5ED3E3E7CA5B4B5C83B8E01E5FCF

4

NIST curve B-409

0200000000000000000000000000000000000000

0000000000000000000000000000000000000000008000000000000000000001

0000000000000000000000000000000000000000

0000000000000000000000000000000000000000000000000000000000000001

0021A5C2C8EE9FEB5C4B9A753B7B476B7FD6422E

F1F3DD674761FA99D6AC27C8A9A197B272822F6CD57A55AA4F50AE317B13545F

015D4860D088DDB3496B0C6064756260441CDE4A

F1771D4DB01FFE5B34E59703DC255A868A1180515603AEAB60794E54BB7996A7

0061B1CFAB6BE5F32BBFA78324ED106A7636B9C5

A7BD198D0158AA4F5488D08F38514F1FDF4B4F40D2181B3681C364BA0273C706

0100000000000000000000000000000000000000

00000000000001E2AAD6A612F33307BE5FA47C3C9E052F838164CD37D9A21173

2

NIST curve K-571

800000000000000

0000000000000000000000000000000000000000000000000000000000000000

0000000000000000000000000000000000000000000000000000000000000425

0

1

026EB7A859923FBC

82189631F8103FE4AC9CA2970012D5D46024804801841CA44370958493B205E6

47DA304DB4CEB08CBBD1BA39494776FB988B47174DCA88C7E2945283A01C8972

0349DC807F4FBF37

4F4AEADE3BCA95314DD58CEC9F307A54FFC61EFC006D8A2C9D4979C0AC44AEA7

4FBEBBB9F772AEDCB620B01A7BA7AF1B320430C8591984F601CD4C143EF1C7A3

0200000000000000

00000000000000000000000000000000000000000000000000000000131850E1

F19A63E4B391A8DB917F4138B630D84BE5D639381E91DEB45CFE778F637C1001

4

NIST curve B-571

800000000000000

0000000000000000000000000000000000000000000000000000000000000000

0000000000000000000000000000000000000000000000000000000000000425

0000000000000000

0000000000000000000000000000000000000000000000000000000000000000

0000000000000000000000000000000000000000000000000000000000000001

02F40E7E2221F295

DE297117B7F3D62F5C6A97FFCB8CEFF1CD6BA8CE4A9A18AD84FFABBD8EFA5933

2BE7AD6756A66E294AFD185A78FF12AA520E4DE739BACA0C7FFEFF7F2955727A

0303001D34B85629

6C16C0D40D3CD7750A93D1D2955FA80AA5F40FC8DB7B2ABDBDE53950F4C0D293

CDD711A35B67FB1499AE60038614F1394ABFA3B4C850D927E1E7769C8EEC2D19

037BF27342DA639B

6DCCFFFEB73D69D78C6C27A6009CBBCA1980F8533921E8A684423E43BAB08A57

6291AF8F461BB2A8B3531D2F0485C19B16E2F1516E23DD3C1A4827AF1B8AC15B

03FFFFFFFFFFFFFF

FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE661CE18

FF55987308059B186823851EC7DD9CA1161DE93D5174D66E8382E9BB2FE84E47

2

%s -- Generator

x

y

%s -- Generator:

x

y

combined multiplication ...

13

3

1

Curve defined by Weierstrass equation

y^2 + x*y = x^3 + a*x^2 + b (mod p)

a

b

p

6

8

Point is not on curve

x

y

A cyclic subgroup:

point at infinity

x

y

Generator as octet string, compressed form:

Generator as octet string, uncompressed form:

Generator as octet string, hybrid form:

\n

EC_GROUP_new_curve_name() failed with curve %s\n

EC_GROUP_check() failed with curve %s\n

Curve %s failed\n

FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001

FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE

B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4

E84FB0B8E7000CB657D7973CF6B42ED78B301674276DF744AF130B3E

4376675C6FC5612C21A0FF2D2A89D2987DF7A2BC52183B5982298555

B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21

BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34

FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D

3F0C488E987C80BE0FEE521F8D90BE6034EC69AE11CA72AA777481E8

ffffffff00000001000000000000000000000000ffffffffffffffffffffffff

ffffffff00000001000000000000000000000000fffffffffffffffffffffffc

5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b

b7e08afdfe94bad3f1dc8c734798ba1c62b3a0ad1e9ea2a38201cd0889bc7a19

3603f747959dbf7a4bb226e41928729063adc7ae43529e61b563bbc606cc5e09

6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296

4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5

ffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551

c477f9f65c22cce20657faa5b2d1d8122336f851a508a1ed04e479c34985bf96

1ff

ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff

ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff

1ff

ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff

fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc

051

953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e1

56193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00

0098

e91eef9a68452822309c52fab453f5f117c1da8ed796b255e9ab8f6410cca16e

59df403a6bdc6ca467a37056b1e54b3005d8ac030decfeb68df18b171885d5c4

0164

350c321aecfc1cca1ba4364c9b15656150b4b78d6a48d7d28e7f31985ef17be8

554376b72900712c4b83ad668327231526e313f5f092999a4632fd50d946bc2e

c6

858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dba

a14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66

118

39296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c

97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650

1ff

fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa

51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409

0100

085f47b8e1b8b11b7eb33028c0b2888e304bfc98501955b45bba1478dc184eee

df09b86a5f7c21994406072787205e69a63709fe35aa93ba333514b24f961722

NIST curve P-%d (optimised implementation):

NIST test vectors ...

