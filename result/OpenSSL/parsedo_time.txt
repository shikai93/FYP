Copyright 2001-2017 The OpenSSL Project Authors. All Rights Reserved. Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at https://www.openssl.org/source/license.html

On VMS, gmtime_r() takes a 32-bit pointer as second argument. Since we can't know that |result| is in a space that can easily translate to a 32-bit pointer, we must store temporarily on stack and copy the result. The stack is always reachable with 32-bit pointers.

Take a tm structure and add an offset to it. This avoids any OS issues with restricted date types and overflows which cause the year 2038 problem.

Convert time and offset into Julian day and seconds

Convert Julian day back to date

Update tm structure

Adjust differences so both positive or both negative

Convert tm structure and offset into julian day and seconds

split offset into days and day seconds

Avoid sign issues with % operator

Add current time seconds to offset

Adjust day seconds if overflow

Convert date of time structure into a Julian day number.

Work out Julian day of new date

Convert date to and from julian day Uses Fliegel & Van Flandern algorithm

www.openssl.org/source/license.html

License

