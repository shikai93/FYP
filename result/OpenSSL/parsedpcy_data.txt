Copyright 2004-2016 The OpenSSL Project Authors. All Rights Reserved. Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at https://www.openssl.org/source/license.html

Policy Node routines

Don't free qualifiers if shared

Create a data based on an existing policy. If 'id' is NULL use the OID in the policy, otherwise use 'id'. This behaviour covers the two types of data in RFC3280: data with from a CertificatePolicies extension and additional data with just the qualifiers of anyPolicy and ID from another source.

www.openssl.org/source/license.html

License

internal/cryptlib.h

pcy_int.h

t free qualifiers if shared */ if (!(data->flags & POLICY_DATA_FLAG_SHARED_QUALIFIERS)) sk_POLICYQUALINFO_pop_free(data->qualifier_set, POLICYQUALINFO_free); sk_ASN1_OBJECT_pop_free(data->expected_policy_set, ASN1_OBJECT_free); OPENSSL_free(data); } /* * Create a data based on an existing policy. If

is NULL use the OID in * the policy, otherwise use

