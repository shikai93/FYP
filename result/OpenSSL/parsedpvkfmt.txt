Copyright 2005-2016 The OpenSSL Project Authors. All Rights Reserved. Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at https://www.openssl.org/source/license.html

Support for PVK format keys and related structures (such a PUBLICKEYBLOB and PRIVATEKEYBLOB).

Utility function: read a DWORD (4 byte unsigned integer) in little endian format

Read a BIGNUM in little endian format. The docs say that this should take up bitlen/8 bytes.

Convert private key blob to EVP_PKEY: RSA and DSA keys supported

Maximum length of a blob after header

The PVK file magic number: seems to spell out "bobsfile", who is Bob?

Salt length for PVK files

Maximum length in PVK header

Maximum salt length

bType

Version

Ignore reserved, aiKeyAlg

fall thru

fall thru

Expected length: 20 for q + 3 components bitlen each + 24 for seed structure.

Expected length: 20 for q, priv, 2 bitlen components + 24 for seed structure.

Expected length: 4 for 'e' + 'n'

Expected length: 4 for 'e' and 7 other components. 2 components are bitlen size, 5 are bitlen/2

Calculate public key

For private key each component must fit within nbyte or hnbyte.

Set "invalid" for seed structure values

Skip reserved

keytype =

Copy BLOBHEADER across, decrypt rest

www.openssl.org/source/license.html

License

internal/cryptlib.h

bobsfile

e

n

e

invalid

0x6

0x7

0x31415352L

0x32415352L

0x31535344L

0x32535344L

0xa400

0x2200

0x1

0x2

0xb0b5f11eL

0x10

0x2)

0xff;

0xff;

0xff;

0xff;

0x2;

0xff,

