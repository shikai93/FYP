Copyright 1995-2016 The OpenSSL Project Authors. All Rights Reserved. Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at https://www.openssl.org/source/license.html

NB: these functions have been "upgraded", the deprecated versions (which are compatibility wrappers using these functions) are in rsa_depr.c. - Geoff

NB: this wrapper would normally be placed in rsa_lib.c and the static implementation would probably be in rsa_eay.c. Nonetheless, is kept here so that we don't introduce a new linker dependency. Eg. any application that wasn't previously linking object code related to key-generation won't have to now just because key-generation is part of RSA_METHOD.

When generating ridiculously small keys, we can get stuck continually regenerating the same prime values.

we set our own err

We need the RSA components non-NULL

generate p and q

calculate n

calculate d

p-1

q-1

(p-1)(q-1)

d

We MUST free pr0 before any further use of r0

calculate d mod (p-1)

calculate d mod (q-1)

We MUST free d before any further use of rsa->d

calculate inverse of q mod p

We MUST free p before any further use of rsa->p

www.openssl.org/source/license.html

License

upgraded

internal/cryptlib.h

rsa_locl.h

t introduce a new linker dependency. Eg. any application * that wasn

