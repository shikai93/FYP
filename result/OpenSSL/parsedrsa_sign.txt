Copyright 1995-2016 The OpenSSL Project Authors. All Rights Reserved. Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at https://www.openssl.org/source/license.html

Size of an SSL signature: MD5+SHA1

encode_pkcs1 encodes a DigestInfo prefix of hash |type| and digest |m|, as described in EMSA-PKCS1-v1_5-ENCODE, RFC 3447 section 9.2 step 2. This encodes the DigestInfo (T and tLen) but does not add the padding. On success, it returns one and sets |out| to a newly allocated buffer containing the result and |out_len| to its length. The caller must free |out| with |OPENSSL_free|. Otherwise, it returns zero.

Compute the encoded digest.

NID_md5_sha1 corresponds to the MD5/SHA1 combination in TLS 1.1 and earlier. It has no DigestInfo wrapper but otherwise is RSASSA-PKCS1-v1_5.

int_rsa_verify verifies an RSA signature in |sigbuf| using |rsa|. It may be called in two modes. If |rm| is NULL, it verifies the signature for digest |m|. Otherwise, it recovers the digest from the signature, writing the digest to |rm| and the length to |prm_len|. |type| is the NID of the digest algorithm to use. It returns one on successful verification and zero otherwise.

Recover the encoded digest.

NID_md5_sha1 corresponds to the MD5/SHA1 combination in TLS 1.1 and earlier. It has no DigestInfo wrapper but otherwise is RSASSA-PKCS1-v1_5.

Oddball MDC2 case: signature can be OCTET STRING. check for correct tag and length octets.

If recovering the digest, extract a digest-sized output from the end of |decrypt_buf| for |encode_pkcs1|, then compare the decryption output as in a standard verification.

Construct the encoded digest and ensure it matches.

Output the recovered digest.

www.openssl.org/source/license.html

License

internal/cryptlib.h

internal/x509_int.h

rsa_locl.h

0x04

0x10)

