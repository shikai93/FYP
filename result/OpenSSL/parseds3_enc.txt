Copyright 1995-2016 The OpenSSL Project Authors. All Rights Reserved. Copyright 2005 Nokia. All rights reserved. Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at https://www.openssl.org/source/license.html

'A' in ASCII

bug: 'buf' is too small for this ciphersuite

m == NULL will lead to a crash later

make sure it's initialised in case we exit later with an error

COMPRESS

make sure it's initialised in case we exit later with an error

COMPRESS

enable vulnerability countermeasure for CBC ciphers with known-IV problem (http://www.openssl.org/~bodo/tls-cbc.txt)

Free digest list. Also frees handshake buffer since they are always freed together.

Note: this writes to a memory BIO so a failure is a fatal error

TODO(size_t) : convert me

Don't send it :-)

www.openssl.org/source/license.html

www.openssl.org/~bodo/tls-cbc.txt)

License

ssl_locl.h

internal/cryptlib.h

A

A

buf

s initialised in case we exit later with an error */ EVP_CIPHER_CTX_reset(s->enc_read_ctx); dd = s->enc_read_ctx; if (ssl_replace_hash(&s->read_hash, m) == NULL) { SSLerr(SSL_F_SSL3_CHANGE_CIPHER_STATE, ERR_R_INTERNAL_ERROR); goto err2; } #ifndef OPENSSL_NO_COMP /* COMPRESS */ COMP_CTX_free(s->expand); s->expand = NULL; if (comp != NULL) { s->expand = COMP_CTX_new(comp); if (s->expand == NULL) { SSLerr(SSL_F_SSL3_CHANGE_CIPHER_STATE, SSL_R_COMPRESSION_LIBRARY_ERROR); goto err2; } } #endif RECORD_LAYER_reset_read_sequence(&s->rlayer); mac_secret = &(s->s3->read_mac_secret[0]); } else { if (s->enc_write_ctx != NULL) reuse_dd = 1; else if ((s->enc_write_ctx = EVP_CIPHER_CTX_new()) == NULL) goto err; else /* * make sure it

A

BB

CCC

\x41

\x42\x42

\x43\x43\x43

