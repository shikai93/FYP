Copyright 2017 The OpenSSL Project Authors. All Rights Reserved. Copyright 2017 BaishanCloud. All rights reserved. Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at https://www.openssl.org/source/license.html

Skip the record header

Skip the handshake message header

Skip client version and random

Skip session id

Skip ciphers

Skip compression

Extensions len

Loop through all extensions for SNI

use TLS_method to blur 'side'

set SNI before 'client side' is set

This shouldn't succeed because we don't have a server!

no SNI in client hello

incorrect SNI value

use TLS_method to blur 'side'

set SNI after 'client side' is set

This shouldn't succeed because we don't have a server!

no SNI in client hello

incorrect SNI value

use TLS_server_method to choose 'server-side'

set SNI at server side

This shouldn't succeed because we have nothing to listen on

SNI should be cleared by SSL_accpet

For each test set up an SSL_CTX and SSL and see what SNI behaves.

www.openssl.org/source/license.html

License

../ssl/packet_locl.h

testutil.h

internal/nelem.h

dummy-host

side

client side

t succeed because we don

side

client side

t succeed because we don

server-side

