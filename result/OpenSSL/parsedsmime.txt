Copyright 1999-2017 The OpenSSL Project Authors. All Rights Reserved. Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at https://www.openssl.org/source/license.html

S/MIME utility function

If previous -signer argument add signer to list

If previous -inkey argument add signer to list

Check to see if any final signer needs to be appended

If detached data content we only enable streaming if S/MIME output format.

If not streaming or resigning finalize structure

Minimal callback just to output policy info (if any)

www.openssl.org/source/license.html

License

apps.h

-

Usage: %s [options] cert.pem...\n

-

cert.pem... recipient certs for encryption\n

-

Valid options are:\n

help

-

Display this summary

encrypt

-

Encrypt message

decrypt

-

Decrypt encrypted message

sign

-

Sign message

verify

-

Verify signed message

pk7out

-

Output PKCS#7 structure

nointern

-

Don't search certificates in message for signer

nosigs

-

Don't verify message signature

noverify

-

Don't verify signers certificate

nocerts

-

Don't include signers certificate when signing

nodetach

-

Use opaque signing

noattr

-

Don't include any signed attributes

binary

-

Don't translate message to text

certfile

<

Other certificates file

signer

s

Signer certificate file

recip

<

Recipient certificate file for decryption

in

<

Input file

inform

c

Input format SMIME (default), PEM or DER

inkey

s

Input private key (if not signer or recipient)

keyform

f

Input private key format (PEM or ENGINE)

out

>

Output file

outform

c

Output format SMIME (default), PEM or DER

content

<

Supply or override content for detached signature

to

s

To address

from

s

From address

subject

s

Subject

text

-

Include or delete text MIME headers

CApath

/

Trusted certificates directory

CAfile

<

Trusted certificates file

no-CAfile

-

Do not load the default certificates file

no-CApath

-

Do not load certificates from the default certificates directory

resign

-

Resign a signed message

nochain

-

set PKCS7_NOCHAIN so certificates contained in the message are not used as untrusted CAs

nosmimecap

-

Omit the SMIMECapabilities attribute

stream

-

Enable CMS streaming

indef

-

Same as -stream

noindef

-

Disable CMS streaming

crlfeol

-

Use CRLF as EOL termination instead of CR only

passin

s

Input file pass phrase source

md

s

Digest algorithm to use when signing or resigning



-

Any supported cipher

engine

s

Use engine, possibly a hardware device

\n

%s: Use -help for summary.\n

\r\n

%s: Must have -signer before -inkey\n

Multiple signers or keys not allowed\n

Illegal -inkey without -signer\n

No signer certificate specified\n

No recipient certificate or key specified\n

No recipient(s) certificate(s) specified\n

Error getting password\n

No cipher selected\n

recipient certificate file

certificate file

recipient certificate file

signing key file

r

Bad input format for PKCS#7 file\n

Error reading S/MIME message\n

rb

Can't read content file %s\n

w

signer certificate

signing key file

Error creating PKCS#7 structure\n

Error decrypting PKCS#7 structure\n

Verification successful\n

Verification failure\n

Error writing signers to %s\n

To: %s%s

From: %s%s

Subject: %s%s

Bad output format for PKCS#7 file\n

Error writing output\n

w

0x10

0x20

0x40

