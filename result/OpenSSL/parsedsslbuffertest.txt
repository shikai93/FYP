Copyright 2016-2017 The OpenSSL Project Authors. All Rights Reserved. Licensed under the OpenSSL licenses, (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at https://www.openssl.org/source/license.html or in the file LICENSE in the source distribution.

There are 9 passes in the tests 0 = control test tests during writes 1 = free buffers 2 = + allocate buffers after free 3 = + allocate buffers again 4 = + free buffers after allocation tests during reads 5 = + free buffers 6 = + free buffers again 7 = + allocate buffers after free 8 = + free buffers after allocation

Send and receive some test data. Do the whole thing twice to ensure we hit at least one async event in both reading and writing

Write some test data. It should never take more than 2 attempts (the first one might be a retryable fail).

test == 0 mean to free/allocate = control

allocate a second time

Now read the test data. It may take more attempts here because it could fail once for each byte read, including all overhead bytes from the record header/padding etc.

free a second time

www.openssl.org/source/license.html

License

../ssl/packet_locl.h

ssltestlib.h

testutil.h

Test data

Test %d failed: Create SSL objects failed\n

Test %d failed: Create SSL connection failed\n

Test %d failed: Failed to write app data\n

Test %d failed: Failed to read app data\n

Failed to create SSL_CTX pair\n

