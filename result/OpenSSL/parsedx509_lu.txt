Copyright 1995-2017 The OpenSSL Project Authors. All Rights Reserved. Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at https://www.openssl.org/source/license.html

abort();

a new one

obj not pushed

abort();

Nothing found in cache: do lookup to possibly add new objects to cache

Always do lookup to possibly add new CRLs to cache

Try to get issuer certificate from store. Due to limitations of the API this can only retrieve a single certificate matching a given subject name. However it will fill the cache with all matching certificates, so we can examine the cache for all matches. Return values are: 1 lookup successful. 0 certificate not found. -1 some other error.

If certificate matches all OK

Else find index of first cert accepted by 'check_issued'

should be true as we've had at least one match

Look through all matching certs for suitable issuer

See if we've run past the matches

If times check, exit with match, otherwise keep looking. Leave last match in issuer so we return nearest match if no certificate time is OK.

www.openssl.org/source/license.html

License

internal/cryptlib.h

internal/refcount.h

internal/x509_int.h

x509_lcl.h

X509_STORE

X509_STORE

check_issued

ve had at least one * match */ /* Look through all matching certs for suitable issuer */ for (i = idx; i < sk_X509_OBJECT_num(ctx->ctx->objs); i++) { pobj = sk_X509_OBJECT_value(ctx->ctx->objs, i); /* See if we

