Copyright 2004-2016 The OpenSSL Project Authors. All Rights Reserved. Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at https://www.openssl.org/source/license.html

X509_VERIFY_PARAM functions

Refuse names with embedded NUL bytes, except perhaps as final byte. XXX: Do we need to push an error onto the error stack?

param->inh_flags = X509_VP_FLAG_DEFAULT;

-1 means unset, 0 is explicit

This function determines how parameters are "inherited" from one structure to another. There are several different ways this can happen. 1. If a child structure needs to have its values initialized from a parent they are simply copied across. For example SSL_CTX copied to SSL. 2. If the structure should take on values only if they are currently unset. For example the values in an SSL structure will take appropriate value for SSL servers or clients but only if the application has not set new ones. The "inh_flags" field determines how this function behaves. Normally any values which are set in the default are not copied from the destination and verify flags are ORed together. If X509_VP_FLAG_DEFAULT is set then anything set in the source is copied to the destination. Effectively the values in "to" become default values which will be used only if nothing new is set in "from". If X509_VP_FLAG_OVERWRITE is set then all value are copied across whether they are set or not. Flags is still Ored though. If X509_VP_FLAG_RESET_FLAGS is set then the flags value is copied instead of ORed. If X509_VP_FLAG_LOCKED is set then no values are copied. If X509_VP_FLAG_ONCE is set then the current inh_flags setting is zeroed after the next call.

Macro to test if a field should be copied from src to dest

Macro to test and copy a field if necessary

If overwrite or check time not set, copy across

Don't need to copy flag: that is done below

Copy the host flags if and only if we're copying the host list

Move peername from one param structure to another, freeing any name present at the target. If the source is a NULL parameter structure, free and zero the target peername.

Default verify parameters: these are used for various applications and can be overridden by the user specified table. NB: the 'name' field must be in alphabetical order because it will be searched using OBJ_search.

X509 default parameters

Check time

internal flags

flags

purpose

trust

depth

auth_level

policies

S/MIME sign parameters

Check time

internal flags

flags

purpose

trust

depth

auth_level

policies

S/MIME sign parameters

Check time

internal flags

flags

purpose

trust

depth

auth_level

policies

SSL/TLS client parameters

Check time

internal flags

flags

purpose

trust

depth

auth_level

policies

SSL/TLS server parameters

Check time

internal flags

flags

purpose

trust

depth

auth_level

policies

www.openssl.org/source/license.html

License

internal/cryptlib.h

internal/x509_int.h

x509_lcl.h

\0

\0

inherited

inh_flags

to

from

t need to copy flag: that is done below */ } if (inh_flags & X509_VP_FLAG_RESET_FLAGS) dest->flags = 0; dest->flags |= src->flags; if (test_x509_verify_param_copy(policies, NULL)) { if (!X509_VERIFY_PARAM_set1_policies(dest, src->policies)) return 0; } /* Copy the host flags if and only if we

name

default

pkcs7

smime_sign

ssl_client

ssl_server

