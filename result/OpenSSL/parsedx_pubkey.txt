Copyright 1995-2016 The OpenSSL Project Authors. All Rights Reserved. Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at https://www.openssl.org/source/license.html

Minor tweak to operation: free up EVP_PKEY

Attempt to decode public key and cache in pubkey structure.

Opportunistically decode the key but remove any non fatal errors from the queue. Subsequent explicit attempts to decode/use the key will return an appropriate error.

Attempt to decode a public key. Returns 1 on success, 0 for a decode failure and -1 for a fatal error e.g. malloc failure.

Treat any failure of pub_decode as a decode error. In future we could have different return codes for decode errors and fatal errors such as malloc failure.

When the key ASN.1 is initially parsed an attempt is made to decode the public key and cache the EVP_PKEY structure. If this operation fails the cached value will be NULL. Parsing continues to allow parsing of unknown key types or unsupported forms. We repeat the decode operation so the appropriate errors are left in the queue.

If decode doesn't fail something bad happened

Now two pseudo ASN1 routines that take an EVP_PKEY structure and encode or decode as X509_PUBKEY

The following are equivalents but which return RSA and DSA keys

Set number of unused bits to zero

www.openssl.org/source/license.html

License

internal/cryptlib.h

internal/asn1_int.h

internal/evp_int.h

internal/x509_int.h

0x07);

