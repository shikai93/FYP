Copyright 1995-2016 The OpenSSL Project Authors. All Rights Reserved. Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at https://www.openssl.org/source/license.html

X509_REQ_INFO is handled in an unusual way to get round invalid encodings. Some broken certificate requests don't encode the attributes field if it is empty. This is in violation of PKCS#10 but we need to tolerate it. We do this by making the attributes field OPTIONAL then using the callback to initialise it to an empty STACK. This means that the field will be correctly encoded unless we NULL out the field. As a result we no longer need the req_kludge field because the information is now contained in the attributes field: 1. If it is NULL then it's the invalid omission. 2. If it is empty it is the correct encoding. 3. If it is not empty then some attributes are present.

This isn't really OPTIONAL but it gets round invalid encodings

www.openssl.org/source/license.html

License

internal/cryptlib.h

internal/x509_int.h

t * encode the attributes field if it is empty. This is in * violation of PKCS#10 but we need to tolerate it. We do * this by making the attributes field OPTIONAL then using * the callback to initialise it to an empty STACK. * * This means that the field will be correctly encoded unless * we NULL out the field. * * As a result we no longer need the req_kludge field because * the information is now contained in the attributes field: * 1. If it is NULL then it

